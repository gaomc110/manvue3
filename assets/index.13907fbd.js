import{d as e,c as s,_ as a,o as r,a as o,p as t,b as n,e as l,E as i,r as u,u as d,f as m,g as c,h as g,t as p,i as h,j as f,k as v,l as b,w as P,m as w,n as j,q as F,s as _,v as S,x as R}from"./index.244b8970.js";/* empty css                  */const V=e({setup:()=>({carouselItem:s((()=>[{slogan:"Vue3+Vite2.X+TypeScript+...",subSlogan:"2022年最新Vue技术栈，最强配置",image:"/assets/login-banner.426fb77f.png"},{slogan:"开箱即用，多种插件，动态加载",subSlogan:"可支持大型中后台应用或轻量级无线端应用",image:"/assets/banner2.84a48f34.svg"},{slogan:"社区维护，来芜湖四海大厂核心大牛",subSlogan:"扫码进入社区微信群",image:"/assets/qunerweima.f98dd09a.jpg"}]))})}),y={class:"banner"},q=[(e=>(t("data-v-b57174ba"),e=e(),n(),e))((()=>l("div",{class:"banner-inner"},null,-1)))];var I=a(V,[["render",function(e,s,a,t,n,l){return r(),o("div",y,q)}],["__scopeId","data-v-b57174ba"]]);let T;function k(e,s="warning",a=1e3){T&&T.close(),T=i({message:e,type:s,duration:a})}const C={userLogin:"/api/auth/login/login",userRegister:"/api/auth/login/register",sendCaptcha:"/api/auth/email/sendCaptcha",resetPassword:"/api/auth/user/reset-password",permissionRoutes:"/api/auth/permission/routes",userInfo:"/api/auth/login/userInfo"};class O{static postLogin(e){return u({url:C.userLogin,method:"POST",json:!0,data:e}).then((e=>0===e.status?Promise.resolve(e):Promise.reject(e)))}static postRegister(e){return u({url:C.userRegister,method:"POST",json:!0,data:e}).then((e=>0===e.status?Promise.resolve(e):Promise.reject(e)))}static postCaptcha(e){return u({url:C.sendCaptcha,method:"POST",json:!0,data:e}).then((e=>0===e.status?Promise.resolve(e):Promise.reject(e)))}static postResetPwd(e){return u({url:C.resetPassword,method:"POST",json:!0,data:e}).then((e=>0===e.status?Promise.resolve(e):Promise.reject(e)))}static postAuthPermission(e){return u({url:C.permissionRoutes,method:"POST",json:!0,data:e}).then((e=>(console.log(e),0===e.status?Promise.resolve(e):Promise.reject(e))))}static postAuthUserInfo(e){return u({url:C.userInfo,method:"POST",json:!0,data:e}).then((e=>0===e.status?Promise.resolve(e):Promise.reject(e)))}}const L=e({name:"LoginForm",setup(){const e=h(),s=f(),a=d(),r=m(),o=c(""),t=g({loginForm:{username:"",password:""}});return{errorMessage:o,ruleFormRef:c(),rules:g({username:[{required:!0,message:"用户名不能为空"}],password:[{required:!0,message:"密码不能为空"}]}),...p(t),handleSubmit:async o=>{console.log(o),o&&await o.validate((async o=>{var n,l;if(o){const{username:o,password:i}=t.loginForm,u={username:o,password:i},d=await O.postLogin(u);console.log(d);const m=await O.postAuthUserInfo({username:o}),c=null!=(l=null==(n=null==d?void 0:d.data)?void 0:n.accessToken)?l:null;if(c)if(console.log(m),console.log(c),console.log(r),await r.getPermissonRoutes(m.data),await a.setToken(c),console.log(e),console.log(s.query.redirect),s.query.redirect){const a=s.query.redirect;e.push({path:a})}else k("欢迎使用","success"),e.push("/home");else k("账号或者密码有误","warning")}else k("错误信息","error")}))},resetForm:e=>{e&&e.resetFields()}}}}),x=e=>(t("data-v-34f44279"),e=e(),n(),e),U={class:"login-form-wrapper"},A=x((()=>l("div",{class:"login-form-title"},"欢迎登录",-1))),M=x((()=>l("div",{class:"login-form-sub-title"},"Vue3+Vite+ts+pinia+elementPlus架构系统",-1))),E={class:"login-form-error-msg"};var X=a(L,[["render",function(e,s,a,t,n,i){const u=j,d=F,m=_,c=S;return r(),o("div",U,[A,M,l("div",E,v(e.errorMessage),1),b(c,{ref:"ruleFormRef",model:e.loginForm,class:"login-form",layout:"vertical",rules:e.rules},{default:P((()=>[b(d,{prop:"username",rules:[{required:!0,message:"用户名不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:P((()=>[b(u,{modelValue:e.loginForm.username,"onUpdate:modelValue":s[0]||(s[0]=s=>e.loginForm.username=s),placeholder:"admin"},null,8,["modelValue"])])),_:1}),b(d,{prop:"password",rules:[{required:!0,message:"密码不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:P((()=>[b(u,{modelValue:e.loginForm.password,"onUpdate:modelValue":s[1]||(s[1]=s=>e.loginForm.password=s),placeholder:"123456","allow-clear":""},null,8,["modelValue"])])),_:1}),b(m,{type:"primary",onClick:s[2]||(s[2]=s=>e.handleSubmit(e.ruleFormRef))},{default:P((()=>[w("登录")])),_:1}),b(m,{onClick:s[3]||(s[3]=s=>e.resetForm(e.ruleFormRef)),block:""},{default:P((()=>[w("重置")])),_:1})])),_:1},8,["model","rules"])])}],["__scopeId","data-v-34f44279"]]);const z={class:"container"},B={class:"logo"},D=["src"],G={class:"content"},H={class:"content-inner"};var J=a(e({__name:"index",setup:e=>(e,s)=>(r(),o("div",z,[l("div",B,[l("img",{src:R("/assets/logo.db578899.svg"),width:"240"},null,8,D)]),b(I),l("div",G,[l("div",H,[b(X)])])]))}),[["__scopeId","data-v-66bf3bbe"]]);export{J as default};
